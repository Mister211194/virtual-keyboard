(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,a;return n=t,(a=[{key:"_createContainer",value:function(){return this._container=document.createElement("main"),this._container.classList.add("container"),this._container.append(this._createTitle(),this._createTextarea(),this._createKeyboardContainer(),this._createNewText("p","Клавиатура создана в операционной системе Windows"),this._createNewText("p","Для переключения языка комбинация: левыe <b>ctrl</b> + <b>alt</b>")),this._container}},{key:"_createNewText",value:function(e,t){return this._text=document.createElement(e),this._text.classList.add("text"),this._text.innerHTML=t,this._text}},{key:"_createTitle",value:function(){return this._title=document.createElement("h1"),this._title.classList.add("title"),this._title.textContent="Virtual keyboard",this._title}},{key:"_createTextarea",value:function(){return this._textarea=document.createElement("textarea"),this._textarea.classList.add("show-output"),this._textarea}},{key:"_createKeyboardContainer",value:function(){return this._keyboard=document.createElement("div"),this._keyboard.classList.add("keyboard"),this._keyboard}},{key:"renderToDom",value:function(){this._body=document.querySelector("body"),this._body.prepend(this._createContainer())}}])&&e(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,c=function(){};return{s:c,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw r}}}}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=function(){function e(t){var n=t.container,a=t.keys,o=t.lang;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._keyboardContainer=document.querySelector(n),this._keys=a,this._lang=o,this._caps=!0,this._shift=!0,this._textarea=document.querySelector(".show-output"),this._cursorPos=this._textarea.selectionStart}var t,o;return t=e,o=[{key:"_renderer",value:function(){var e=this;this._keys.forEach((function(t){e._row=e._createKeysRow(),t.forEach((function(t){e._item=t,e._key=e._switchLangInit(t),e._caps=t.caps?t.caps:"no-caps",e._shift=t.shift?"shift":"no-shift",e._Element=e._createElementKey(e._key,t.code,e._caps,e._shift);var n=e._Element;e._keyEventListener(t,n),e._row.append(n)})),e._keyboardContainer.append(e._row)}))}},{key:"_keyEventListener",value:function(e,t){var n=this;switch(e.code){case"CapsLock":this._capsEvetnListener();break;case"Backspace":this._backspaceEventListener(e,t);break;case"Tab":t.addEventListener("click",(function(){var e=n._textarea.value.slice(0,n._cursorPos),t=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(e,"    ").concat(t),n._cursorPos+=4})),document.addEventListener("keydown",(function(e){if("Tab"===e.code){t.classList.add("keyboard__key_active");var a=n._textarea.value.slice(0,n._cursorPos),o=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(a,"    ").concat(o),n._cursorPos+=4,n._textarea.selectionEnd=n._cursorPos}})),document.addEventListener("keyup",(function(n){n.code===e.code&&t.classList.remove("keyboard__key_active")}));break;case"Delete":t.addEventListener("click",(function(){var e=n._textarea.value.slice(0,n._cursorPos),t=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(e).concat(t.slice(1))})),document.addEventListener("keydown",(function(a){if(a.code===e.code){t.classList.add("keyboard__key_active");var o=n._textarea.value.slice(0,n._cursorPos),c=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(o).concat(c.slice(1)),n._textarea.selectionEnd=n._cursorPos}})),document.addEventListener("keyup",(function(n){n.code===e.code&&t.classList.remove("keyboard__key_active")}));break;case"Enter":t.addEventListener("click",(function(){var e=n._textarea.value.slice(0,n._cursorPos),t=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(e,"\n").concat(t),n._cursorPos+=1})),document.addEventListener("keydown",(function(a){if(a.code===e.code){t.classList.add("keyboard__key_active");var o=n._textarea.value.slice(0,n._cursorPos),c=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(o,"\n").concat(c),n._cursorPos+=1,n._textarea.selectionEnd=n._cursorPos}})),document.addEventListener("keyup",(function(n){n.code===e.code&&t.classList.remove("keyboard__key_active")}));break;case"ShiftLeft":case"ShiftRight":t.addEventListener("mousedown",(function(){n._chengeShiftElements(),n._shift=!n._shift})),t.addEventListener("mouseup",(function(){n._chengeShiftElements(),n._shift=!n._shift}));var a=!0;document.addEventListener("keydown",(function(o){"undefined"!==o.repeat&&(a=!o.repeat),a&&o.code===e.code&&(t.classList.add("keyboard__key_active"),n._chengeShiftElements(),n._shift=!n._shift)})),document.addEventListener("keyup",(function(o){o.code===e.code&&(t.classList.remove("keyboard__key_active"),n._chengeShiftElements(),n._shift=!n._shift,a=!0)}));break;case"ControlLeft":case"MetaLeft":case"AltLeft":case"AltRight":case"ControlRight":document.addEventListener("keydown",(function(n){n.preventDefault(),n.code===e.code&&t.classList.add("keyboard__key_active")})),document.addEventListener("keyup",(function(n){n.code===e.code&&t.classList.remove("keyboard__key_active")}));break;default:t.addEventListener("click",(function(){var e=n._textarea.value.slice(0,n._cursorPos),a=n._textarea.value.slice(n._cursorPos);n._textarea.value="".concat(e).concat(t.textContent).concat(a),n._cursorPos+=1})),this._defaultKeyListener(e.code,t)}}},{key:"_capsEvetnListener",value:function(){var e=this,t=this._Element;t.classList.add("keyboard__key_activatable"),t.addEventListener("click",(function(){t.classList.toggle("keyboard__key_activatable_active"),e._toggleCaps()}));var n=!0;document.addEventListener("keydown",(function(a){"undefined"!==a.repeat&&(n=!a.repeat),n&&"CapsLock"===a.code&&(t.classList.toggle("keyboard__key_activatable_active"),t.classList.add("keyboard__key_active"),e._toggleCaps())})),document.addEventListener("keyup",(function(e){"CapsLock"===e.code&&(n=!0),t.classList.remove("keyboard__key_active")}))}},{key:"_backspaceEventListener",value:function(e,t){var n=this;t.addEventListener("click",(function(){n._textarea.value=n._textarea.value.substring(0,n._cursorPos-1)+n._textarea.value.substring(n._cursorPos,n._value),n._cursorPos>0?n._cursorPos--:n._cursorPos=0})),document.addEventListener("keydown",(function(a){a.code===e.code&&(t.classList.add("keyboard__key_active"),n._textarea.value=n._textarea.value.substring(0,n._cursorPos-1)+n._textarea.value.substring(n._cursorPos,n._value),n._cursorPos>0?n._cursorPos--:n._cursorPos=0,n._textarea.selectionEnd=n._cursorPos)})),document.addEventListener("keyup",(function(n){n.code===e.code&&t.classList.remove("keyboard__key_active")}))}},{key:"_defaultKeyListener",value:function(e,t){var n=this;document.addEventListener("keydown",(function(a){var o=n._textarea.value.slice(0,n._cursorPos),c=n._textarea.value.slice(n._cursorPos);a.code===e&&(t.classList.add("keyboard__key_active"),n._textarea.value="".concat(o).concat(t.textContent).concat(c),n._cursorPos+=1,n._textarea.selectionEnd=n._cursorPos)})),document.addEventListener("keyup",(function(n){n.code===e&&t.classList.remove("keyboard__key_active")}))}},{key:"_toggleCaps",value:function(){var e=this;a(document.querySelectorAll(".caps")).forEach((function(t){t.textContent=e._caps?t.textContent.toUpperCase():t.textContent.toLowerCase()})),this._caps=!this._caps}},{key:"_switchLangInit",value:function(e){return this._lang?e.key:e.keyRu?e.keyRu:e.key}},{key:"_createKeysRow",value:function(){return this._keysRow=document.createElement("div"),this._keysRow.classList.add("keyboard__row"),this._keysRow}},{key:"_createElementKey",value:function(e,t,n,a){this._keyElement=document.createElement("button"),this._keyElement.classList.add("keyboard__key",t,n,a),this._keyElement.textContent=e;var o=this._keyElement;return o.addEventListener("mousedown",(function(){return o.classList.add("keyboard__key_active")})),o}},{key:"_chengeShiftElements",value:function(){var e=this;a(document.querySelectorAll(".keyboard__key")).forEach((function(t){"`"!==t.textContent&&"~"!==t.textContent||(t.textContent=e._shift?"~":"`"),"1"!==t.textContent&&"!"!==t.textContent||(t.textContent=e._shift?"!":"1"),"2"!==t.textContent&&"@"!==t.textContent||(t.textContent=e._shift?"@":"2"),"3"!==t.textContent&&"#"!==t.textContent||(t.textContent=e._shift?"#":"3"),"4"!==t.textContent&&"$"!==t.textContent||(t.textContent=e._shift?"$":"4"),"5"!==t.textContent&&"%"!==t.textContent||(t.textContent=e._shift?"%":"5"),"6"!==t.textContent&&"^"!==t.textContent||(t.textContent=e._shift?"^":"6"),"7"!==t.textContent&&"&"!==t.textContent||(t.textContent=e._shift?"&":"7"),"8"!==t.textContent&&"*"!==t.textContent||(t.textContent=e._shift?"*":"8"),"9"!==t.textContent&&"("!==t.textContent||(t.textContent=e._shift?"(":"9"),"0"!==t.textContent&&")"!==t.textContent||(t.textContent=e._shift?")":"0"),"-"!==t.textContent&&"_"!==t.textContent||(t.textContent=e._shift?"_":"-"),"="!==t.textContent&&"+"!==t.textContent||(t.textContent=e._shift?"+":"="),"["!==t.textContent&&"{"!==t.textContent||(t.textContent=e._shift?"{":"["),"]"!==t.textContent&&"}"!==t.textContent||(t.textContent=e._shift?"}":"]"),"\\"!==t.textContent&&"|"!==t.textContent||(t.textContent=e._shift?"|":"\\"),";"!==t.textContent&&":"!==t.textContent||(t.textContent=e._shift?":":";"),"'"!==t.textContent&&'"'!==t.textContent||(t.textContent=e._shift?'"':"'"),","!==t.textContent&&"<"!==t.textContent||(e._lang&&(t.textContent=e._shift?"<":","),!1===e._lang&&(t.textContent=".")),"."!==t.textContent&&">"!==t.textContent||(e._lang&&(t.textContent=e._shift?">":"."),!1===e._lang&&(t.textContent=e._shift?",":".")),"/"!==t.textContent&&"?"!==t.textContent||(t.textContent=e._shift?"?":"/")})),a(document.querySelectorAll(".caps")).forEach((function(t){t.textContent=e._shift?t.textContent.toUpperCase():t.textContent.toLowerCase()})),this._toggleCaps()}},{key:"_toggleLang",value:function(){for(var e=this,t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];var r=new Set;document.addEventListener("keydown",(function(t){r.add(t.code);var c,s=n(o);try{for(s.s();!(c=s.n()).done;){var i=c.value;if(!r.has(i))return}}catch(e){s.e(e)}finally{s.f()}r.clear(),a(document.querySelectorAll(".keyboard__key")).forEach((function(t,n){var a=e._keys.flat();e._lang?(t.textContent=a[n].keyRu?a[n].keyRu:a[n].key,e._toggleCaps()):(t.textContent=a[n].key,e._toggleCaps())})),e._lang=!e._lang,window.localStorage.setItem("lang",JSON.stringify(e._lang))})),document.addEventListener("keyup",(function(e){r.delete(e.code)}))}},{key:"setEventListener",value:function(){var e=this;window.addEventListener("DOMContentLoaded",(function(){e._renderer(),e._toggleLang("ControlLeft","AltLeft"),e._toggleLang("ControlLeft","ControlRight")})),document.addEventListener("mouseup",(function(){a(document.querySelectorAll(".keyboard__key")).forEach((function(e){e.classList.remove("keyboard__key_active")}))})),this._textarea.addEventListener("click",(function(){e._cursorPos=e._textarea.selectionStart}))}}],o&&r(t.prototype,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),i={container:".keyboard",keys:[[{key:"`",code:"Backquote",keyRu:"ё",caps:"caps"},{key:"1",code:"Digit1"},{key:"2",code:"Digit2"},{key:"3",code:"Digit3"},{key:"4",code:"Digit4"},{key:"5",code:"Digit5"},{key:"6",code:"Digit6"},{key:"7",code:"Digit7"},{key:"8",code:"Digit8"},{key:"9",code:"Digit9"},{key:"0",code:"Digit0"},{key:"-",code:"Minus"},{key:"=",code:"Equal"},{key:"Backspace",code:"Backspace"}],[{key:"Tab",code:"Tab"},{key:"q",code:"KeyQ",keyRu:"й",caps:"caps"},{key:"w",code:"KeyW",keyRu:"ц",caps:"caps"},{key:"e",code:"KeyE",keyRu:"у",caps:"caps"},{key:"r",code:"KeyR",keyRu:"к",caps:"caps"},{key:"t",code:"KeyT",keyRu:"е",caps:"caps"},{key:"y",code:"KeyY",keyRu:"н",caps:"caps"},{key:"u",code:"KeyU",keyRu:"г",caps:"caps"},{key:"i",code:"KeyI",keyRu:"ш",caps:"caps"},{key:"o",code:"KeyO",keyRu:"щ",caps:"caps"},{key:"p",code:"KeyP",keyRu:"з",caps:"caps"},{key:"[",code:"BracketLeft",keyRu:"х",caps:"caps"},{key:"]",code:"BracketRight",keyRu:"ъ",caps:"caps"},{key:"\\",code:"Backslash"},{key:"Del",code:"Delete"}],[{key:"CapsLock",code:"CapsLock"},{key:"a",code:"KeyA",keyRu:"ф",caps:"caps"},{key:"s",code:"KeyS",keyRu:"ы",caps:"caps"},{key:"d",code:"KeyD",keyRu:"в",caps:"caps"},{key:"f",code:"KeyF",keyRu:"а",caps:"caps"},{key:"g",code:"KeyG",keyRu:"п",caps:"caps"},{key:"h",code:"KeyH",keyRu:"р",caps:"caps"},{key:"j",code:"KeyJ",keyRu:"о",caps:"caps"},{key:"k",code:"KeyK",keyRu:"л",caps:"caps"},{key:"l",code:"KeyL",keyRu:"д",caps:"caps"},{key:";",code:"Semicolon",keyRu:"ж",caps:"caps"},{key:"'",code:"Quote",keyRu:"э",caps:"caps"},{key:"Enter",code:"Enter"}],[{key:"Shift",code:"ShiftLeft"},{key:"z",code:"KeyZ",keyRu:"я",caps:"caps"},{key:"x",code:"KeyX",keyRu:"ч",caps:"caps"},{key:"c",code:"KeyC",keyRu:"с",caps:"caps"},{key:"v",code:"KeyV",keyRu:"м",caps:"caps"},{key:"b",code:"KeyB",keyRu:"и",caps:"caps"},{key:"n",code:"KeyN",keyRu:"т",caps:"caps"},{key:"m",code:"KeyM",keyRu:"ь",caps:"caps"},{key:",",code:"Comma",keyRu:"б",caps:"caps"},{key:".",code:"Period",keyRu:"ю",caps:"caps"},{key:"/",code:"Slash",keyRu:"."},{key:"▲",code:"ArrowUp"},{key:"Shift",code:"ShiftRight"}],[{key:"Ctrl",code:"ControlLeft"},{key:"Win",code:"MetaLeft"},{key:"Alt",code:"AltLeft"},{key:" ",code:"Space"},{key:"Alt",code:"AltRight"},{key:"◄",code:"ArrowLeft"},{key:"▼",code:"ArrowDown"},{key:"►",code:"ArrowRight"},{key:"Ctrl",code:"ControlRight"}]],lang:!0};function u(){return JSON.parse(window.localStorage.getItem("lang"))}i.lang=u(),(new t).renderToDom(),new s(i).setEventListener(),window.addEventListener("load",u)})();